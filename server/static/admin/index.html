<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Feedback Bot</title>
  <link rel="stylesheet" href="/static/admin/admin.css?v=2.2">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ¯ Admin Dashboard - Bot Feedback System</h1>
      <p>Review conversations, provide feedback, and improve bot responses</p>
    </header>

    <nav class="tabs">
      <button class="tab active" onclick="switchTab('conversations')">ğŸ’¬ Conversations</button>
      <button class="tab" onclick="switchTab('analytics')">ğŸ“Š Analytics</button>
      <button class="tab" onclick="switchTab('approved')">â­ Approved Responses</button>
    </nav>

    <!-- Conversations Tab -->
    <div id="conversations-tab" class="tab-content active">
      <div class="summary-banner" id="summary-banner">
        <!-- Summary will be loaded here -->
      </div>
      
      <div class="filters-modern">
        <div class="filters-row">
          <div class="filter-item">
            <label class="filter-label">ğŸ“± Channel</label>
            <select id="channel-filter" class="filter-select" onchange="loadConversations()">
              <option value="">All Channels</option>
              <option value="web">ğŸ’» Web</option>
              <option value="phone">ğŸ“ Phone</option>
            </select>
          </div>
          
          <div class="filter-item">
            <label class="filter-label">ğŸ“… Start Date</label>
            <input type="date" id="start-date" class="filter-input" onchange="loadConversations()" />
          </div>
          
          <div class="filter-item">
            <label class="filter-label">ğŸ“… End Date</label>
            <input type="date" id="end-date" class="filter-input" onchange="loadConversations()" />
          </div>
        </div>
        
        <div class="filters-row">
          <div class="filter-toggle">
            <label class="toggle-container">
              <input type="checkbox" id="needs-review-filter" onchange="loadConversations()" checked />
              <span class="toggle-slider"></span>
              <span class="toggle-label">ğŸ¤– Show only AI-flagged conversations</span>
            </label>
          </div>
          
          <div class="filter-actions">
            <button onclick="loadConversations()" class="btn-secondary">ğŸ”„ Refresh</button>
            <button onclick="evaluateAllConversations()" class="btn-primary">ğŸ¤– Auto-Evaluate All</button>
          </div>
        </div>
      </div>

      <div id="conversations-list" class="conversations-list">
        <!-- Conversations will be loaded here -->
      </div>

      <div class="pagination">
        <button id="prev-page" onclick="previousPage()">â† Previous</button>
        <span id="page-info">Page 1</span>
        <button id="next-page" onclick="nextPage()">Next â†’</button>
      </div>
    </div>

    <!-- Analytics Tab -->
    <div id="analytics-tab" class="tab-content">
      <h2>ğŸ“Š Dashboard Metrics</h2>
      <div id="analytics-content" class="analytics-grid">
        <!-- Analytics will be loaded here -->
      </div>
    </div>

    <!-- Approved Responses Tab -->
    <div id="approved-tab" class="tab-content">
      <h2>â­ Approved Responses for Learning</h2>
      <div id="approved-content">
        <!-- Approved responses will be loaded here -->
      </div>
    </div>
  </div>

  <!-- Conversation Detail Modal -->
  <div id="conversation-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2>Conversation Details</h2>
      <div id="conversation-detail"></div>
    </div>
  </div>

  <!-- Inline Feedback Form Template (hidden, will be cloned) -->
  <template id="feedback-form-template">
    <div class="inline-feedback-form">
      <h4>ğŸ’¬ Provide Feedback</h4>
      
      <label>Rating:</label>
      <div class="rating">
        <button type="button" onclick="setInlineRating(this, 1)">â­</button>
        <button type="button" onclick="setInlineRating(this, 2)">â­â­</button>
        <button type="button" onclick="setInlineRating(this, 3)">â­â­â­</button>
        <button type="button" onclick="setInlineRating(this, 4)">â­â­â­â­</button>
        <button type="button" onclick="setInlineRating(this, 5)">â­â­â­â­â­</button>
      </div>
      <input type="hidden" class="selected-rating" value="3">
      
      <label>Tags:</label>
      <div class="tags">
        <label><input type="checkbox" value="helpful"> Helpful</label>
        <label><input type="checkbox" value="accurate"> Accurate</label>
        <label><input type="checkbox" value="wrong_info"> Wrong Info</label>
        <label><input type="checkbox" value="tone_issue"> Tone Issue</label>
        <label><input type="checkbox" value="context_lost"> Context Lost</label>
        <label><input type="checkbox" value="excellent"> Excellent</label>
      </div>
      
      <label>Admin Comment:</label>
      <textarea class="admin-comment" rows="3" placeholder="Your feedback..."></textarea>
      
      <label>Corrected Response (optional):</label>
      <textarea class="corrected-response" rows="4" placeholder="Provide a better response..."></textarea>
      
      <div class="feedback-actions">
        <button onclick="submitInlineFeedback(this)" class="submit-btn">ğŸ’¾ Submit Feedback</button>
        <button onclick="approveInlineResponse(this)" class="approve-btn">âœ… Approve for Learning</button>
        <button onclick="closeInlineFeedback(this)" class="cancel-btn">âœ–ï¸ Cancel</button>
      </div>
    </div>
  </template>

  <script src="/static/admin/admin.js?v=2.2"></script>
</body>
</html>
